import { Options } from "nodemailer/lib/mailer";
import mailConfig from '../config/mailConfig';
import { AppMailProvider } from './../interfaces/IMailProvider';
import { createTransport } from "nodemailer";
import { handlebarOptions } from "../config/expressHandlebarsConfig";
import hbs from "nodemailer-express-handlebars";

export class MailProvider implements AppMailProvider.IMailProvider {
    sendEmail: AppMailProvider.SendEmail.Handler = ({
        to,
        subject,
        template,
        message,
        context,
    }) => {
        try {
            console.log('sendEmail:', {
                to,
                subject,
                template,
                context,
            });

            console.log('mailConfig:', mailConfig);

            if (
                (context && !template) ||
                (!context && template) ||
                (!context && !template && !message)
            )
                throw new Error("Argumentos invalidos");

            const mailOptions: Options & Pick<AppMailProvider.SendEmail.Args, "context" | "template"> = {
                from: mailConfig.auth.user,
                to,
                context,
                subject,
                template,
                html: message,
                attachments: [{
                    filename: "test.png",
                    content:
                        "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",
                    cid: "logo",
                    encoding: "base64",
                    contentType: "image/png",
                }]
            }

            if (!message) delete mailOptions.html;


            const transporter = createTransport({
                host: mailConfig.host,
                port: Number(mailConfig.port),
                secure: true,
                auth: {
                    user: mailConfig.auth.user,
                    pass: mailConfig.auth.pass,
                },
                tls: {
                    rejectUnauthorized: false,
                },
            });

            transporter.use("compile", hbs(handlebarOptions));


            transporter.sendMail(mailOptions, (error, info) => {
                if (error)
                    // eslint-disable-next-line no-console
                    console.error(
                        "🆘 \t file: Mail.ts:36 \t transporter.sendMail \t error:",
                        error
                    );
                // eslint-disable-next-line no-console
                else console.log(`E-mail sent: ${info.response}`);
            });

        } catch (error) {
            throw {
                message: "Falhou ao enviar email",
                statusCode: 500,
                details: error,
            };
        }
    }
}